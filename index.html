<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Visor Excel - ABRIL</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    table.dataTable thead th {
      background-color: #d6f5d6;
      font-weight: bold;
      border-bottom: 2px solid #333;
    }
    table.dataTable tbody td {
      border-bottom: 1px solid #ccc;
    }
  </style>
</head>
<body>

<h2>Contenido del Excel - ABRIL</h2>
<table id="tablaExcel" class="display"></table>

<script>
  async function cargarExcel() {
    const url = 'https://raw.githubusercontent.com/SimVia88/visor-excel/main/Diario-ambiental-de-obra-ABRIL.xlsx';
    const res = await fetch(url);
    const data = await res.arrayBuffer();
    const workbook = XLSX.read(data, { type: 'array' });
    const hoja = workbook.SheetNames[0];
    const filas = XLSX.utils.sheet_to_json(workbook.Sheets[hoja], { header: 1 });

    const encabezados = filas[5]; // Fila 6 en Excel
    const registros = filas.slice(6); // A partir de la fila 7 (datos reales)

    let html = '<thead><tr>';
    encabezados.forEach(col => html += `<th>${col}</th>`);
    html += '</tr></thead><tbody>';
    registros.forEach(fila => {
      html += '<tr>';
      encabezados.forEach((_, i) => {
        html += `<td>${fila[i] ?? ''}</td>`;
      });
      html += '</tr>';
    });
    html += '</tbody>';

    $('#tablaExcel').html(html);
    $('#tablaExcel').DataTable({ scrollX: true });
  }

  cargarExcel();
</script>

</body>
</html>
